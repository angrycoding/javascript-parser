<!DOCTYPE HTML>
<html>
	<head>
		<title>krang</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<script type="text/javascript" src="beautify.js"></script>
		<script type="text/javascript" src="krang.js"></script>

		<script id="script" type="text/plain">

			x:
			y:
			z:

			({
				true: true,
				false: false,
				null: 10,
				hex: 0x41,
				string: 'string',
				foo: (2 + 2),
				array: [1, 2, 3],
				_this: this,
				_null: _foo,
				new: new Constructor(),
				function: function x(a, b, c) {

				}
			}.whilex)


			do {

			} while (2 * 2);

			throw foo;

		</script>

		<script type="text/javascript">

			function dump(value) {
				console.info(
					js_beautify(
						JSON.stringify(
							value,
							function(x, y) {
								if (typeof y === 'function')
									return y.toString()
								return y
							}
						)
					)
				);
			}


			var script = document.getElementById('script').innerHTML;

			krang({cache: false, debug: false}).require([
				'src/Tokenizer',
				'src/Parser',
				'src/Generator'
			], function(Tokenizer, Parser, Generator) {

				// var token = new Tokenizer();
				// token.addToken('@SPACES', /[\x09\x20]+/);
				// token.addToken('@EOL', /[\x0A\x0D]+/);
				// token.addToken(':');

				// token.addToken('keyword', /for\b/);
				// token.addToken('keyword', /while\b/);
				// token.addToken('keyword', /do\b/);
				// token.addToken('id', /[a-zA-Z]+/);

				// token.addToken('number', /[0-9]+/);
				// token.tokenize(script);

				// console.info(token.next('@id'))

				// return;



				// while (!token.test('EOF')) {
				// 	console.error(token.next('import'));
				// 	console.info(token.next());
				// }
				// console.info(token.next());


				var AST = Parser(script);
				dump(AST);
				var code = Generator(AST);

				console.info(code);

			});

		</script>


	</head>
	<body>

	</body>
</html>